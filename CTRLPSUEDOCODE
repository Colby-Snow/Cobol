VARIABLE DECLARATIONS
	Alphanumeric - I-FNAME, I-LNAME, H-LNAME, H-FNAME, O-TIME, O-TOTAL-GAMES, O-TOTAL-AVG, O-MJ-TOTAL-AVG, O-MJ-TOTAL-GAMES
		O-GT-TOTAL-GAMES, O-GT-TOTAL-AVG
	Numeric - I-TIME, C-TOTAL-GAMES, C-TOTAL-AVG, C-MJ-TOTAL-GAMES = 0, C-MJ-TOTAL-AVG = 0, 
		C-GT-TOTAL-GAMES = 0, C-GT-TOTAL-AVG = 0, C-PCTR = 0, I-DATE
	
MAIN
	INIT
	WHILE MORE-RECTS = "YES"
		IF H-FNAME != I-FNAME || H-LNAME != I-LNAME
			MAJOR SUBTOTALS
		CALL MAINLINE
	CALL CLOSING

MAINLINE
	CALL CALCS
	CALL OUTPUT
	CALL READ
	
INIT
	OPEN INPUT FILE
	OPEN OUTPUT FILE
	REQUEST SYSTEM DATE
	GET I-DATE
	O-DATE = I-DATE
	CALL READ
	CALL HEADINGS
	H-FNAME = I-FNAME
	H-LNAME = I-LNAME

READ
	READ RECORD I-FNAME, I-LNAME, I-TIME
	IF END OF FILE
		MORE-RECTS = "NO"

HEADINGS
	C-PCTR += 1
	O-PCTR = C-PCTR
	PRINT TITLE LINE
	PRINT BLANK LINE
	PRINT COLUMN HEADING LINE 1
	PRINT BLANK LINE
	
	
CALC
	C-MJ-TOTAL-AVG +=  I-TIME
	C-MJ-TOTAL-GAMES += 1
	
	
OUTPUT
	O-TIME = I-TIME

	PRINT DETAIL LINE I-LNAME, I-FNAME, O-TIME
	IF EOP
		CALL HEADINGS
		
CLOSING
	CALL MAJOR SUBTOTALS
	CALL GRANDTOTALS
	CLOSE INPUT FILE
	CLOSE OUTPUT FILE
	
MAJOR SUBTOTALS
	C-MJ-TOTAL-AVG = C-MJ-TOTAL-AVG / C-MJ-TOTAL-GAMES
	O-MJ-TOTAL-AVG = C-MJ-TOTAL-AVG
	O-MJ-TOTAL-GAMES = C-MJ-TOTAL-GAMES
	
	PRINT MAJOR SUBTOTALS O-MJ-TOTAL-AVG, O-MJ-TOTAL-GAMES, H-FNAME, H-LNAME
		IF EOP
		CALL HEADINGS
	
	C-GT-TOTAL-AVG += C-MJ-TOTAL-AVG
	C-GT-TOTAL-GAMES += C-MJ-TOTAL-GAMES
	C-MJ-TOTAL-AVG = 0
	C-MJ-TOTAL-GAMES = 0
	H-FNAME = I-FNAME
	H-LNAME = I-LNAME

GRANDTOTALS
	C-GT-TOTAL-AVG = C-GT-TOTAL-AVG / C-GT-TOTAL-GAMES
	O-GT-TOTAL-AVG = C-GT-TOTAL-AVG
	O-GT-TOTAL-GAMES = C-GT-TOTAL-GAMES
	
	PRINT MAJOR SUBTOTALS O-GT-TOTAL-AVG, O-GT-TOTAL-GAMES
	
	C-GT-TOTAL-AVG += C-MJ-TOTAL-AVG
	C-GT-TOTAL-GAMES += C-MJ-TOTAL-GAMES