VARIABLE DECLARATIONS
	Alphanumeric - I-LAST-NAME, I-STATE, I-BOAT-TYPE, MORE-RECS, H-BOAT-TYPE, O-LAST-NAME, O-STATE,
		O-BOAT-COST, O-PURCHASE-DATE, O-ACCESSORY-PACKAGE,  O-PREP-DELIVER-COST, O-TOT-COST, O-DATE, O-BOAT-TYPE
	Numeric - C-PCTR = 0, I-DATE, I-BOAT-COST, I-PURCHASE-DATE, I-ACCESSORY-PACKAGE, I-PREP-DELIVER-COST,
		C-MJ-SOLD, C-TOT-COST, C-MJ-TOT-COST, C-GT-SOLD, C-GT-TOT-COST
	
MAIN
	INIT
	WHILE MORE-RECS = "YES"
		CALL MAINLINE
	CALL CLOSING

MAINLINE
	IF H-BOAT-TYPE != I-BOAT-TYPE
		MAJOR SUBTOTALS
		BOATHEADING
	CALL CALCS
	CALL OUTPUT
	CALL READ
	
INIT
	OPEN INPUT FILE
	OPEN OUTPUT FILE
	REQUEST SYSTEM DATE
	GET I-DATE
	O-DATE = I-DATE
	CALL READ
	H-BOAT-TYPE = I-BOAT-TYPE
	CALL HEADINGS

READ
	READ RECORD I-LAST-NAME, I-STATE, I-BOAT-COST, I-PURCHASE-DATE, I-BOAT-TYPE, I-ACCESSORY-PACKAGE, I-PREP-DELIVER-COST
	IF END OF FILE
		MORE-RECTS = "NO"

HEADINGS
	C-PCTR += 1
	O-PCTR = C-PCTR
	PRINT TITLE LINE
	PRINT BLANK LINE
	PRINT COLUMN HEADING LINE 1
	PRINT COLUMN HEADING LINE 2
	BOATHEADING

CALC
	C-TOT-COST = I-BOAT-COST + I-PREP-DELIVER-COST
	C-MJ-TOT-COST += C-TOT-COST 
	C-MJ-SOLD += 1
	
OUTPUT
	SELECT I-ACCESSORY-PACKAGE
		CASE 1:
			O-ACCESSORY-PACKAGE = "ELECTRONICS"
		CASE 2:
			O-ACCESSORY-PACKAGE = "SKI PACKAGE"
		CASE 3:
			O-ACCESSORY-PACKAGE = "FISHING PACKAGE"

	O-LAST-NAME = I-LAST-NAME
	O-STATE = I-STATE
	O-BOAT-COST = I-BOAT-COST
	O-PURCHASE-DATE = I-PURCHASE-DATE
	O-PREP-DELIVER-COST = I-PREP-DELIVER-COST
	O-TOT-COST = C-TOT-COST

	PRINT DETAIL LINE O-LAST-NAME, O-STATE, O-BOAT-COST, O-PURCHASE-DATE, O-ACCESSORY-PACKAGE,
		O-ACCESSORY-PACKAGE, O-PREP-DELIVER-COST, O-TOT-COST, O-BOAT-TYPE
	IF EOP
		CALL HEADINGS
		
BOATHEADING
	SELECT I-BOAT-TYPE
		CASE "B":
			O-BOAT-TYPE = "BASS BOAT"
		CASE"P":
			O-BOAT-TYPE = "PONTOON"
		CASE"S":
			O-BOAT-TYPE = "SKI BOAT"
		CASE"J":
			O-BOAT-TYPE = "JOHN BOAT"
		CASE"C":
			O-BOAT-TYPE = "CANOE"
		CASE"R":
			O-BOAT-TYPE = "CABIN CRUISER"
			
	PRINT BLANK LINE
	PRINT BOAT-TYPE LINE O-BOAT-TYPE
	PRINT BLANK LINE
		
CLOSING
	CALL MAJOR SUBTOTALS
	CALL GRANDTOTALS
	CLOSE INPUT FILE
	CLOSE OUTPUT FILE
	
MAJOR SUBTOTALS
	O-MJ-TOT-COST = C-MJ-TOT-COST
	O-MJ-SOLD = C-MJ-SOLD
	
	PRINT MAJOR SUBTOTALS O-MJ-TOT-COST, O-MJ-SOLD, O-BOAT-TYPE
		IF EOP
		CALL HEADINGS
	PRINT BLANK LINE
	
	C-GT-SOLD += C-MJ-SOLD
	C-GT-TOT-COST += C-MJ-TOT-COST
	H-BOAT-TYPE = I-BOAT-TYPE

GRANDTOTALS
	O-GT-TOT-COST = C-GT-TOT-COST
	O-GT-SOLD = C-GT-TOTAL-AVG
	
	PRINT BLANK LINE
	PRINT MAJOR SUBTOTALS O-GT-TOT-COST, O-GT-SOLD
	PRINT BLANK LINE