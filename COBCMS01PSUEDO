VARIABLE DECLARATIONS
	Alphanumeric - I-PAINT-REC, MORE-RECTS = "YES", O-DATE, O-PAINT-DATE, O-PAINT-EST-NO,
		O-PAINT-WALL-SQ-FT, O-PAINT-DOOR-SQ-FT, O-TOTAL-SQ-FT, O-AMT-PAINT-GAL, O-PAINT-PRICE-GAL, O-PAINT-EST, 
		O-LABOR-EST, O-TOTAL-EST, O-GT-PAINT-EST, O-GT-LABOR-EST, O-GT-TOTAL-EST, O-GT-RECORDS, O-GT-PAINT-GAL
	Numeric - I-PAINT-DATE, I-PAINT-EST-NO, I-PAINT-WALL-SQ-FT, I-PAINT-DOOR-SQ-FT, I-PAINT-PRICE-GAL,
		I-DATE, C-GT-TOTAL-EST = 0, C-PCTR = 0, C-PAINT-EST, C-LABOR-EST, C-TOTAL-SQ-FT, C-TOTAL-EST,
		C-AMT-PAINT-GAL, C-GT-LABOR-EST = 0, C-GT-PAINT-EST = 0, C-GT-PAINT-GAL = 0, C-GT-RECORDS
	
MAIN
	INIT
	WHILE MORE-RECTS = "YES"
		CALL MAINLINE
	CALL CLOSING

MAINLINE
	CALL CALCS
	CALL OUTPUT
	CALL READ
	
INIT
	OPEN INPUT FILE
	OPEN OUTPUT FILE
	REQUEST SYSTEM DATE
	GET I-DATE
	O-DATE = I-DATE
	CALL READ
	CALL HEADINGS

READ
	READ RECORD, I-PAINT-DATE, I-PAINT-EST-NO, I-PAINT-WALL-SQ-FT, I-PAINT-DOOR-SQ-FT, I-PAINT-PRICE-GAL
	IF END OF FILE
		MORE-RECTS = "NO"

HEADINGS
	C-PCTR += 1
	O-PCTR = C-PCTR
	PRINT TITLE LINE
	PRINT BLANK LINE
	PRINT COLUMN HEADING LINE 1
	PRINT COLUMN HEADING LINE 2
	PRINT BLANK LINE
	
CALC
	c-TOTAL-SQ-FT = I-WALL-SQ-FT - I-DOOR-SQ-FT
	C-AMT-PAINT-GAL = I-WALL-SQ-FT / 115
	C-PAINT-EST = C-AMT-PAINT-GAL * I-PAINT-PRICE-GAL
	C-LABOR-EST = C-AMT-PAINT-GAL * 3 * 23.55
	C-TOTAL-EST = C-LABOR-EST + C-PAINT-EST

	C-GT-RECORDS += 1
	C-GT-PAINT-GAL += C-AMT-PAINT-GAL
	C-GT-PAINT-EST += C-PAINT-EST
	C-GT-LABOR-EST += C-LABOR-EST
	C-GT-TOTAL-EST += C-TOTAL-EST

OUTPUT
	O-PAINT-EST-NO = I-PAINT-EST-NO
	O-PAINT-DATE = I-PAINT-DATE
	O-PAINT-EST = C-PAINT-EST
	O-LABOR-EST = C-LABOR-EST
	O-WALL-SQ-FT = I-WALL-SQ-FT
	O-DOOR-SQ-FT = I-DOOR-SQ-FT
	O-TOTAL-EST = C-TOTAL-EST
	O-TOTAL-SQ-FT = C-TOTAL-SQ-FT
	O-AMT-PAINT-GAL = C-AMT-PAINT-GAL

	PRINT DETAIL LINE O-PAINT-EST-NO, O-PAINT-DATE, O-PAINT-EST, O-LABOR-EST, O-WALL-SQ-FT, O-DOOR-SQ-FT,
		O-TOTAL-SQ-FT, O-AMT-PAINT-GAL, O-PAINT-PRICE-GAL, O-TOTAL-EST
	IF EOP
		CALL HEADINGS
		
CLOSING
	CALL GRANDTOTALS
	CLOSE INPUT FILE
	CLOSE OUTPUT FILE
	
GRANDTOTALS
	O-GT-RECORDS = C-GT-RECORDS
	O-GT-PAINT-GAL = C-GT-PAINT-GAL
	O-GT-PAINT-EST = C-GT-PAINT-EST
	O-GT-LABOR-EST = C-GT-LABOR-EST
	O-GT-TOTAL-EST = C-GT-TOTAL-EST
	
	PRINT BLANK LINE
	PRINT BLANK LINE
	PRINT GRANDTOTAL LINE O-GT-TOTAL-EST, O-GT-PAINT-EST, O-GT-LABOR-EST, O-GT-PAINT-GAL, O-GT-RECORDS